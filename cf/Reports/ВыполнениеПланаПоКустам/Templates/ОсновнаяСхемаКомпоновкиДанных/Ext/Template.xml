<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>НаборДанных1</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Упаковка</dataPath>
			<field>Упаковка</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Менеджер</dataPath>
			<field>Менеджер</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Менеджер</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ИнтернетЗаказ</dataPath>
			<field>ИнтернетЗаказ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Акция</dataPath>
			<field>Акция</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПроцентРучнойСкидки</dataPath>
			<field>ПроцентРучнойСкидки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПроцентАвтоматическойСкидки</dataPath>
			<field>ПроцентАвтоматическойСкидки</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СтавкаНДС</dataPath>
			<field>СтавкаНДС</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ЗаказПокупателя</dataPath>
			<field>ЗаказПокупателя</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Размещение</dataPath>
			<field>Размещение</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Смена</dataPath>
			<field>Смена</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Контрагент</dataPath>
			<field>Контрагент</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Партнер</dataPath>
			<field>Партнер</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Заказ</dataPath>
			<field>Заказ</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Чек</dataPath>
			<field>Чек</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Отдел</dataPath>
			<field>Отдел</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДокументПродажи</dataPath>
			<field>ДокументПродажи</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Продавец</dataPath>
			<field>Продавец</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Подразделение</dataPath>
			<field>Подразделение</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВаловаяПрибыль</dataPath>
			<field>ВаловаяПрибыль</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Валовая прибыль</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>План</dataPath>
			<field>План</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>План</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СуммаПродажОплаты</dataPath>
			<field>СуммаПродажОплаты</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сумма продаж оплаты</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВыполнениеПланаПоКустам</dataPath>
			<field>ВыполнениеПланаПоКустам</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Выполнение плана по кустам</v8:content>
				</v8:item>
			</title>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДолгиПоЗаказам.Регистратор КАК ДокументОплаты,
	ДолгиПоЗаказам.Контрагент,
	ДолгиПоЗаказам.Заказ,
	ДолгиПоЗаказам.Менеджер КАК МенеджерОплаты,
	ДолгиПоЗаказам.Контрагент.ОсновнойМенеджер КАК ОсновнойМенеджер,
	ВЫБОР
		КОГДА &amp;МенеджерОплаты
			ТОГДА ДолгиПоЗаказам.Менеджер
		ИНАЧЕ ДолгиПоЗаказам.Контрагент.ОсновнойМенеджер
	КОНЕЦ КАК Менеджер,
	СУММА(ДолгиПоЗаказам.Сумма) КАК СуммаОборот
ПОМЕСТИТЬ ОплатыБезОтбора
ИЗ
	РегистрНакопления.ДолгиПоЗаказам КАК ДолгиПоЗаказам
ГДЕ
	ДолгиПоЗаказам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	И ДолгиПоЗаказам.Заказ &lt;&gt; НЕОПРЕДЕЛЕНО
{ГДЕ
	(ДолгиПоЗаказам.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)}

СГРУППИРОВАТЬ ПО
	ДолгиПоЗаказам.Регистратор,
	ДолгиПоЗаказам.Контрагент,
	ДолгиПоЗаказам.Заказ,
	ДолгиПоЗаказам.Менеджер,
	ДолгиПоЗаказам.Контрагент.ОсновнойМенеджер
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ОплатыБезОтбора.ДокументОплаты,
	ОплатыБезОтбора.Контрагент,
	ОплатыБезОтбора.Заказ,
	ОплатыБезОтбора.Менеджер,
	ОплатыБезОтбора.МенеджерОплаты,
	ОплатыБезОтбора.ОсновнойМенеджер,
	ОплатыБезОтбора.СуммаОборот
ПОМЕСТИТЬ Оплаты
ИЗ
	ОплатыБезОтбора КАК ОплатыБезОтбора
{ГДЕ
	(ОплатыБезОтбора.Менеджер В (&amp;Менеджер)),
	(ОплатыБезОтбора.Менеджер.Отдел В ИЕРАРХИИ (&amp;МенеджерОтдел)),
	(ОплатыБезОтбора.Менеджер.Подразделение В ИЕРАРХИИ (&amp;МенеджерПодразделение))}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	Оплаты.Заказ
ПОМЕСТИТЬ Заказы
ИЗ
	Оплаты КАК Оплаты

СГРУППИРОВАТЬ ПО
	Оплаты.Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	Оплаты.Заказ,
	Оплаты.ДокументОплаты КАК ДокументОплаты
ПОМЕСТИТЬ ЗаказыОплаты
ИЗ
	Оплаты КАК Оплаты

СГРУППИРОВАТЬ ПО
	Оплаты.Заказ,
	Оплаты.ДокументОплаты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	Оплаты.ДокументОплаты
ПОМЕСТИТЬ ДокументыОплаты
ИЗ
	Оплаты КАК Оплаты
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Оплат.ДокументОплаты,
	КурсУЕ.Валюта,
	КурсУЕ.Курс,
	КурсУЕ.Кратность,
	Оплат.Заказ
ПОМЕСТИТЬ ТаблицаВалютПоДням
ИЗ
	Оплаты КАК Оплат
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таб.Валюта КАК Валюта,
			Таб.Курс КАК Курс,
			Таб.Период КАК ПериодНач,
			Таб.Кратность КАК Кратность,
			ВЫБОР
				КОГДА МИНИМУМ(Таб1.Период) ЕСТЬ NULL 
					ТОГДА &amp;КонецПериода
				ИНАЧЕ ДОБАВИТЬКДАТЕ(МИНИМУМ(Таб1.Период), СЕКУНДА, -1)
			КОНЕЦ КАК ПериодКон
		ИЗ
			(ВЫБРАТЬ
				КурсыВалют.Валюта КАК Валюта,
				КурсыВалют.Период КАК Период,
				КурсыВалют.Курс КАК Курс,
				КурсыВалют.Кратность КАК Кратность
			ИЗ
				РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					КурсыВалют.Валюта КАК Валюта,
					КурсыВалют.Период КАК Период,
					КурсыВалют.Курс КАК Курс
				ИЗ
					РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб1
				ПО Таб.Валюта = Таб1.Валюта
					И Таб.Период &lt; Таб1.Период
		
		СГРУППИРОВАТЬ ПО
			Таб.Валюта,
			Таб.Курс,
			Таб.Период,
			Таб.Кратность) КАК КурсУЕ
		ПО (Оплат.ДокументОплаты.Дата МЕЖДУ КурсУЕ.ПериодНач И КурсУЕ.ПериодКон)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ЗаказыПокупателейОбороты.ЗаказПокупателя КАК Заказ,
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.ЗаказПокупателя.СуммаВключаетНДС
				И ЗаказыПокупателейОбороты.СтавкаНДС = &amp;Ставка18
			ТОГДА ВЫРАЗИТЬ(ЗаказыПокупателейОбороты.СуммаПриход + ЗаказыПокупателейОбороты.СуммаПриход * 18 / 100 КАК ЧИСЛО(15, 2))
		ИНАЧЕ ЗаказыПокупателейОбороты.СуммаПриход
	КОНЕЦ КАК Сумма,
	ЗаказыПокупателейОбороты.КоличествоПриход КАК Количество
ПОМЕСТИТЬ ТоварыЗаказов
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(
			{(&amp;НачалоПериодаЗаказа)},
			{(&amp;КонецПериодаЗаказа)},
			,
			ЗаказПокупателя В
				(ВЫБРАТЬ
					Заказы.Заказ
				ИЗ
					Заказы)) КАК ЗаказыПокупателейОбороты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Прод.ИнтернетЗаказ,
	Прод.Номенклатура,
	ВЫБОР
		КОГДА НЕ Прод.ИнтернетЗаказ.СуммаВключаетНДС
				И Прод.СтавкаНДС = &amp;Ставка18
			ТОГДА ВЫРАЗИТЬ(Прод.СуммаПриход + Прод.СуммаПриход * 18 / 100 КАК ЧИСЛО(15, 2))
		ИНАЧЕ Прод.СуммаПриход
	КОНЕЦ,
	Прод.КоличествоПриход
ИЗ
	РегистрНакопления.ИнтернетЗаказПокупателя.Обороты(
			{(&amp;НачалоПериодаЗаказа)},
			{(&amp;КонецПериодаЗаказа)},
			,
			ИнтернетЗаказ В
				(ВЫБРАТЬ
					Заказы.Заказ
				ИЗ
					Заказы)) КАК Прод

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	РеализацияПереданныхТоваровТовары.Ссылка,
	РеализацияПереданныхТоваровТовары.Номенклатура,
	ВЫБОР
		КОГДА НЕ РеализацияПереданныхТоваровТовары.Ссылка.СуммаВключаетНДС
				И РеализацияПереданныхТоваровТовары.СтавкаНДС = &amp;Ставка18
			ТОГДА ВЫРАЗИТЬ(РеализацияПереданныхТоваровТовары.Сумма + РеализацияПереданныхТоваровТовары.Сумма * 18 / 100 КАК ЧИСЛО(15, 2))
		ИНАЧЕ РеализацияПереданныхТоваровТовары.Сумма
	КОНЕЦ,
	РеализацияПереданныхТоваровТовары.Количество
ИЗ
	Документ.РеализацияПереданныхТоваров.Товары КАК РеализацияПереданныхТоваровТовары
ГДЕ
	РеализацияПереданныхТоваровТовары.Ссылка В
			(ВЫБРАТЬ
				Заказы.Заказ
			ИЗ
				Заказы)
{ГДЕ
	(РеализацияПереданныхТоваровТовары.Ссылка.Дата &gt;= &amp;НачалоПериодаЗаказа),
	(РеализацияПереданныхТоваровТовары.Ссылка.Дата &lt;= &amp;КонецПериодаЗаказа)}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТоварыЗаказов.Заказ,
	ТоварыЗаказов.Номенклатура,
	ТоварыЗаказов.Сумма,
	ТоварыЗаказов.Количество,
	ЗаказыОплаты.ДокументОплаты
ПОМЕСТИТЬ втТоварыЗаказовСОплатами
ИЗ
	ТоварыЗаказов КАК ТоварыЗаказов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ЗаказыОплаты КАК ЗаказыОплаты
		ПО ТоварыЗаказов.Заказ = ЗаказыОплаты.Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втБезЦены.ДокументОплаты,
	втБезЦены.Заказ КАК Заказ,
	втБезЦены.Номенклатура КАК Номенклатура,
	МАКСИМУМ(ЦеныНоменклатуры.Период) КАК Период,
	ЦеныНоменклатуры.ТипЦен КАК ТипЦен
ПОМЕСТИТЬ втМаксПериодСебестоимость
ИЗ
	втТоварыЗаказовСОплатами КАК втБезЦены
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры
		ПО втБезЦены.Номенклатура = ЦеныНоменклатуры.Номенклатура
			И втБезЦены.ДокументОплаты.Дата &gt;= ЦеныНоменклатуры.Период
			И (ЦеныНоменклатуры.ТипЦен В
				(ВЫБРАТЬ
					ТипЦенСебестоимостьДляРасчетаЗП.Значение
				ИЗ
					Константа.ТипЦенСебестоимостьДляРасчетаЗП КАК ТипЦенСебестоимостьДляРасчетаЗП))
			И (ЦеныНоменклатуры.Упаковка = &amp;ПустаяУпаковка)

СГРУППИРОВАТЬ ПО
	втБезЦены.ДокументОплаты,
	втБезЦены.Заказ,
	втБезЦены.Номенклатура,
	ЦеныНоменклатуры.ТипЦен
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	втБезЦены.ДокументОплаты,
	втБезЦены.Заказ КАК Заказ,
	втБезЦены.Номенклатура КАК Номенклатура,
	МАКСИМУМ(ЦеныНоменклатуры.Период) КАК Период,
	ЦеныНоменклатуры.ТипЦен КАК ТипЦен
ПОМЕСТИТЬ втМаксПериодЗакупка
ИЗ
	втТоварыЗаказовСОплатами КАК втБезЦены
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры
		ПО втБезЦены.Номенклатура = ЦеныНоменклатуры.Номенклатура
			И втБезЦены.ДокументОплаты.Дата &gt;= ЦеныНоменклатуры.Период
			И (ЦеныНоменклатуры.ТипЦен В
				(ВЫБРАТЬ
					ТипЦенЗакупочныйРуб.Значение
				ИЗ
					Константа.ТипЦенЗакупочныйРуб КАК ТипЦенЗакупочныйРуб))
			И (ЦеныНоменклатуры.Упаковка = &amp;ПустаяУпаковка)

СГРУППИРОВАТЬ ПО
	втБезЦены.ДокументОплаты,
	втБезЦены.Заказ,
	втБезЦены.Номенклатура,
	ЦеныНоменклатуры.ТипЦен
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	втБезЦены.ДокументОплаты КАК ДокументОплаты,
	втБезЦены.Заказ КАК Заказ,
	втБезЦены.Номенклатура КАК Номенклатура,
	ЕСТЬNULL(ЦеныНоменклатурыСебестоимость.Цена, ЕСТЬNULL(ЦеныНоменклатурыЗакупка.Цена, ЕСТЬNULL(ЦенСеб.Цена, ЕСТЬNULL(ЦенЗак.Цена, 0)))) КАК Цена,
	ЕСТЬNULL(ЦеныНоменклатурыСебестоимость.Валюта, ЕСТЬNULL(ЦеныНоменклатурыЗакупка.Валюта, ЕСТЬNULL(ЦенСеб.Валюта, ЕСТЬNULL(ЦенЗак.Валюта, 0)))) КАК Валюта,
	втБезЦены.Сумма КАК СуммаВЗаказе
ПОМЕСТИТЬ втНоменклатураСЦеной
ИЗ
	втТоварыЗаказовСОплатами КАК втБезЦены
		ЛЕВОЕ СОЕДИНЕНИЕ втМаксПериодСебестоимость КАК втМаксПериодСебестоимость
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатурыСебестоимость
			ПО втМаксПериодСебестоимость.Номенклатура = ЦеныНоменклатурыСебестоимость.Номенклатура
				И втМаксПериодСебестоимость.Период = ЦеныНоменклатурыСебестоимость.Период
				И втМаксПериодСебестоимость.ТипЦен = ЦеныНоменклатурыСебестоимость.ТипЦен
		ПО втБезЦены.Номенклатура = втМаксПериодСебестоимость.Номенклатура
			И втБезЦены.Заказ = втМаксПериодСебестоимость.Заказ
			И втБезЦены.ДокументОплаты = втМаксПериодСебестоимость.ДокументОплаты
		ЛЕВОЕ СОЕДИНЕНИЕ втМаксПериодЗакупка КАК втМаксПериодЗакупка
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатурыЗакупка
			ПО втМаксПериодЗакупка.Номенклатура = ЦеныНоменклатурыЗакупка.Номенклатура
				И втМаксПериодЗакупка.Период = ЦеныНоменклатурыЗакупка.Период
				И втМаксПериодЗакупка.ТипЦен = ЦеныНоменклатурыЗакупка.ТипЦен
		ПО втБезЦены.Номенклатура = втМаксПериодЗакупка.Номенклатура
			И втБезЦены.Заказ = втМаксПериодЗакупка.Заказ
			И втБезЦены.ДокументОплаты = втМаксПериодЗакупка.ДокументОплаты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;ЦеныНаДату), (&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенСебестоимостьДляРасчетаЗП.Значение
						ИЗ
							Константа.ТипЦенСебестоимостьДляРасчетаЗП КАК ТипЦенСебестоимостьДляРасчетаЗП)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенСеб
		ПО втБезЦены.Номенклатура = ЦенСеб.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;ЦеныНаДату), (&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенЗакупочныйРуб.Значение
						ИЗ
							Константа.ТипЦенЗакупочныйРуб КАК ТипЦенЗакупочныйРуб)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенЗак
		ПО втБезЦены.Номенклатура = ЦенЗак.Номенклатура
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Прод.ДокументОплаты КАК ДокументОплаты,
	Прод.Заказ КАК Заказ,
	МАКСИМУМ(Прод.Заказ.Сумма) КАК Сумма,
	СУММА(Прод.Количество * ЕСТЬNULL(ЦенСеб.Цена * (ЕСТЬNULL(ТабВал.Курс, 1) * ЕСТЬNULL(ВалРуб.Кратность, 1)) / (ЕСТЬNULL(ТабВал.Кратность, 1) * ЕСТЬNULL(ВалРуб.Курс, 1)), 0)) КАК Себестоимость,
	МАКСИМУМ(ТабВал.Курс) КАК КурсУЕ
ПОМЕСТИТЬ СебестоимостьЗаказов
ИЗ
	втТоварыЗаказовСОплатами КАК Прод
		ЛЕВОЕ СОЕДИНЕНИЕ втНоменклатураСЦеной КАК ЦенСеб
		ПО Прод.Номенклатура = ЦенСеб.Номенклатура
			И Прод.ДокументОплаты = ЦенСеб.ДокументОплаты
			И Прод.Заказ = ЦенСеб.Заказ
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаВалютПоДням КАК ТабВал
		ПО Прод.ДокументОплаты = ТабВал.ДокументОплаты
			И (ЦенСеб.Валюта = ТабВал.Валюта)
			И Прод.Заказ = ТабВал.Заказ
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют.СрезПоследних(
				{(&amp;КонецПериода)},
				Валюта В
					(ВЫБРАТЬ
						Константы.ВалютаУправленческогоУчета
					ИЗ
						Константы)) КАК ВалРуб
		ПО (ИСТИНА)

СГРУППИРОВАТЬ ПО
	Прод.ДокументОплаты,
	Прод.Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Оплат.Менеджер КАК Менеджер,
	Оплат.Контрагент.Категория КАК Категория,
	Оплат.Контрагент КАК Контрагент,
	Оплат.ДокументОплаты,
	Оплат.Заказ КАК Заказ,
	Оплат.СуммаОборот КАК СуммаОплаты,
	Оплат.МенеджерОплаты КАК МенеджерОплаты,
	Оплат.ОсновнойМенеджер КАК ОсновнойМенеджер,
	Себ.Сумма КАК СуммаЗаказа,
	Себ.Себестоимость,
	Себ.КурсУЕ,
	ВЫБОР
		КОГДА ЕСТЬNULL(Себ.Сумма, 0) = 0
			ТОГДА 0
		ИНАЧЕ ВЫБОР
				КОГДА 100 * Оплат.СуммаОборот / Себ.Сумма &gt; 100
					ТОГДА 100
				ИНАЧЕ 100 * Оплат.СуммаОборот / Себ.Сумма
			КОНЕЦ
	КОНЕЦ КАК Процент,
	ВЫБОР
		КОГДА Оплат.СуммаОборот &gt; Себ.Сумма
			ТОГДА 1
		ИНАЧЕ ВЫБОР
				КОГДА ЕСТЬNULL(Себ.Сумма, 0) = 0
					ТОГДА 0
				ИНАЧЕ Оплат.СуммаОборот / Себ.Сумма
			КОНЕЦ
	КОНЕЦ КАК КоэффициентОплаты,
	НАЧАЛОПЕРИОДА(Оплат.ДокументОплаты.Дата, МЕСЯЦ) КАК МесяцОплаты
ПОМЕСТИТЬ втПрибыльПоМенеджерам
ИЗ
	Оплаты КАК Оплат
		ЛЕВОЕ СОЕДИНЕНИЕ СебестоимостьЗаказов КАК Себ
		ПО Оплат.ДокументОплаты = Себ.ДокументОплаты
			И Оплат.Заказ = Себ.Заказ
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втПрибыльПоМенеджерам.Менеджер,
	СУММА(втПрибыльПоМенеджерам.СуммаОплаты) КАК СуммаОплаты,
	СУММА(втПрибыльПоМенеджерам.СуммаОплаты - втПрибыльПоМенеджерам.Себестоимость * втПрибыльПоМенеджерам.КоэффициентОплаты) КАК ВаловаяПрибыль
ПОМЕСТИТЬ втСуммарнаяПрибыльПоМенеджерам
ИЗ
	втПрибыльПоМенеджерам КАК втПрибыльПоМенеджерам

СГРУППИРОВАТЬ ПО
	втПрибыльПоМенеджерам.Менеджер
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Бюджетирование.Аналитика1 КАК Менеджер,
	СУММА(Бюджетирование.Сумма) КАК План
ПОМЕСТИТЬ втПлановыеДанные
ИЗ
	РегистрСведений.Бюджетирование КАК Бюджетирование
ГДЕ
	Бюджетирование.СтатьяБюджета = &amp;СтатьяБюджета
	И Бюджетирование.Сценарий = &amp;Сценарий
{ГДЕ
	(Бюджетирование.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода),
	(Бюджетирование.Аналитика1 В (&amp;Менеджер)),
	(Бюджетирование.Аналитика1.Отдел В ИЕРАРХИИ (&amp;МенеджерОтдел)),
	(Бюджетирование.Аналитика1.Подразделение В ИЕРАРХИИ (&amp;МенеджерПодразделение))}

СГРУППИРОВАТЬ ПО
	Бюджетирование.Аналитика1
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Пользователи.Ссылка
ПОМЕСТИТЬ Авторы
ИЗ
	Справочник.Пользователи КАК Пользователи
{ГДЕ
	(Пользователи.Ссылка В (&amp;Магазин)),
	(Пользователи.Ссылка.Отдел В ИЕРАРХИИ (&amp;МагазинОтдел)),
	(Пользователи.Ссылка.Подразделение В ИЕРАРХИИ (&amp;МагазинПодразделение))}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	Бюджетирование.Отдел КАК ОтделРозница,
	СУММА(Бюджетирование.Сумма) КАК План
ПОМЕСТИТЬ втПлановыеДанныеПоМагазинам
ИЗ
	РегистрСведений.Бюджетирование КАК Бюджетирование
ГДЕ
	Бюджетирование.СтатьяБюджета = &amp;СтатьяБюджета
	И Бюджетирование.Сценарий = &amp;Сценарий
	И Бюджетирование.Отдел В
			(ВЫБРАТЬ
				Авторы.Ссылка.Отдел
			ИЗ
				Авторы
			СГРУППИРОВАТЬ ПО
				Авторы.Ссылка.Отдел)
{ГДЕ
	(Бюджетирование.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)}

СГРУППИРОВАТЬ ПО
	Бюджетирование.Отдел
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДолгиПоЗаказам.Регистратор КАК ДокументОплаты,
	ДолгиПоЗаказам.Партнер,
	ДолгиПоЗаказам.Заказ,
	ДолгиПоЗаказам.Заказ.Автор КАК Автор,
	ДолгиПоЗаказам.Сумма КАК СуммаОборот,
	ДолгиПоЗаказам.Заказ.Склад,
	ДолгиПоЗаказам.Заказ.Отдел,
	ДолгиПоЗаказам.Менеджер
ПОМЕСТИТЬ ОплатыПоМагазинам
ИЗ
	РегистрНакопления.ДолгиПоЗаказам КАК ДолгиПоЗаказам
ГДЕ
	ДолгиПоЗаказам.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	И ДолгиПоЗаказам.Заказ &lt;&gt; НЕОПРЕДЕЛЕНО
	И ДолгиПоЗаказам.Заказ.Автор В
			(ВЫБРАТЬ
				Авторы.Ссылка
			ИЗ
				Авторы)
	И ДолгиПоЗаказам.Менеджер = ЗНАЧЕНИЕ(Справочник.Пользователи.СвободныйЛид)
{ГДЕ
	(ДолгиПоЗаказам.Период МЕЖДУ &amp;НачалоПериода И &amp;КонецПериода)}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ОплатыПоМагазинам.Заказ
ПОМЕСТИТЬ ЗаказыПоМагазинам
ИЗ
	ОплатыПоМагазинам КАК ОплатыПоМагазинам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗЛИЧНЫЕ
	ОплатыПоМагазинам.ДокументОплаты
ПОМЕСТИТЬ ДокументыОплатыПоМагазинам
ИЗ
	ОплатыПоМагазинам КАК ОплатыПоМагазинам
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Оплат.ДокументОплаты,
	КурсУЕ.Валюта,
	КурсУЕ.Курс,
	КурсУЕ.Кратность
ПОМЕСТИТЬ ТаблицаВалютПоДнямПоМагазинам
ИЗ
	ДокументыОплатыПоМагазинам КАК Оплат
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таб.Валюта КАК Валюта,
			Таб.Курс КАК Курс,
			Таб.Период КАК ПериодНач,
			Таб.Кратность КАК Кратность,
			ВЫБОР
				КОГДА МИНИМУМ(Таб1.Период) ЕСТЬ NULL 
					ТОГДА &amp;КонецПериода
				ИНАЧЕ ДОБАВИТЬКДАТЕ(МИНИМУМ(Таб1.Период), СЕКУНДА, -1)
			КОНЕЦ КАК ПериодКон
		ИЗ
			(ВЫБРАТЬ
				КурсыВалют.Валюта КАК Валюта,
				КурсыВалют.Период КАК Период,
				КурсыВалют.Курс КАК Курс,
				КурсыВалют.Кратность КАК Кратность
			ИЗ
				РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					КурсыВалют.Валюта КАК Валюта,
					КурсыВалют.Период КАК Период,
					КурсыВалют.Курс КАК Курс
				ИЗ
					РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб1
				ПО Таб.Валюта = Таб1.Валюта
					И Таб.Период &lt; Таб1.Период
		
		СГРУППИРОВАТЬ ПО
			Таб.Валюта,
			Таб.Курс,
			Таб.Период,
			Таб.Кратность) КАК КурсУЕ
		ПО (Оплат.ДокументОплаты.Дата МЕЖДУ КурсУЕ.ПериодНач И КурсУЕ.ПериодКон)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	Прод.ДокументПродажи КАК ДокументПродажи,
	КурсУЕ.Валюта,
	КурсУЕ.Курс,
	КурсУЕ.Кратность
ПОМЕСТИТЬ ТаблицаВалютПоДнямПродажиНаличка
ИЗ
	РегистрНакопления.Продажи.Обороты({(&amp;НачалоПериода)}, {(&amp;КонецПериода)}, , ) КАК Прод
		ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			Таб.Валюта КАК Валюта,
			Таб.Курс КАК Курс,
			Таб.Период КАК ПериодНач,
			Таб.Кратность КАК Кратность,
			ВЫБОР
				КОГДА МИНИМУМ(Таб1.Период) ЕСТЬ NULL 
					ТОГДА &amp;КонецПериода
				ИНАЧЕ ДОБАВИТЬКДАТЕ(МИНИМУМ(Таб1.Период), СЕКУНДА, -1)
			КОНЕЦ КАК ПериодКон
		ИЗ
			(ВЫБРАТЬ
				КурсыВалют.Валюта КАК Валюта,
				КурсыВалют.Период КАК Период,
				КурсыВалют.Курс КАК Курс,
				КурсыВалют.Кратность КАК Кратность
			ИЗ
				РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб
				ЛЕВОЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
					КурсыВалют.Валюта КАК Валюта,
					КурсыВалют.Период КАК Период,
					КурсыВалют.Курс КАК Курс
				ИЗ
					РегистрСведений.КурсыВалют КАК КурсыВалют) КАК Таб1
				ПО Таб.Валюта = Таб1.Валюта
					И Таб.Период &lt; Таб1.Период
		
		СГРУППИРОВАТЬ ПО
			Таб.Валюта,
			Таб.Курс,
			Таб.Период,
			Таб.Кратность) КАК КурсУЕ
		ПО (Прод.ДокументПродажи.Дата МЕЖДУ КурсУЕ.ПериодНач И КурсУЕ.ПериодКон)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЗаказыПокупателейОбороты.ЗаказПокупателя КАК Заказ,
	ЗаказыПокупателейОбороты.Номенклатура КАК Номенклатура,
	ВЫБОР
		КОГДА НЕ ЗаказыПокупателейОбороты.ЗаказПокупателя.СуммаВключаетНДС
				И ЗаказыПокупателейОбороты.СтавкаНДС = &amp;Ставка18
			ТОГДА ВЫРАЗИТЬ(ЗаказыПокупателейОбороты.СуммаПриход + ЗаказыПокупателейОбороты.СуммаПриход * 18 / 100 КАК ЧИСЛО(15, 2))
		ИНАЧЕ ЗаказыПокупателейОбороты.СуммаПриход
	КОНЕЦ КАК Сумма,
	ЗаказыПокупателейОбороты.КоличествоПриход КАК Количество
ПОМЕСТИТЬ ТоварыЗаказовПоМагазинам
ИЗ
	РегистрНакопления.ЗаказыПокупателей.Обороты(
			{(&amp;НачалоПериодаЗаказа)},
			{(&amp;КонецПериодаЗаказа)},
			,
			ЗаказПокупателя В
				(ВЫБРАТЬ
					ЗаказыПоМагазинам.Заказ
				ИЗ
					ЗаказыПоМагазинам)) КАК ЗаказыПокупателейОбороты

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	Прод.ИнтернетЗаказ,
	Прод.Номенклатура,
	ВЫБОР
		КОГДА НЕ Прод.ИнтернетЗаказ.СуммаВключаетНДС
				И Прод.СтавкаНДС = &amp;Ставка18
			ТОГДА ВЫРАЗИТЬ(Прод.СуммаПриход + Прод.СуммаПриход * 18 / 100 КАК ЧИСЛО(15, 2))
		ИНАЧЕ Прод.СуммаПриход
	КОНЕЦ,
	Прод.КоличествоПриход
ИЗ
	РегистрНакопления.ИнтернетЗаказПокупателя.Обороты(
			{(&amp;НачалоПериодаЗаказа)},
			{(&amp;КонецПериодаЗаказа)},
			,
			ИнтернетЗаказ В
				(ВЫБРАТЬ
					ЗаказыПоМагазинам.Заказ
				ИЗ
					ЗаказыПоМагазинам)) КАК Прод
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(Прод.Сумма) КАК СуммаБезнал,
	СУММА(Прод.Количество * ЕСТЬNULL(ЦенСеб.Цена * (ЕСТЬNULL(ТабВал.Курс, 1) * ЕСТЬNULL(ВалРуб.Кратность, 1)) / (ЕСТЬNULL(ТабВал.Кратность, 1) * ЕСТЬNULL(ВалРуб.Курс, 1)), ЕСТЬNULL(ЦенЗак.Цена * (ЕСТЬNULL(ТабВалЗакуп.Курс, 1) * ЕСТЬNULL(ВалРуб.Кратность, 1)) / (ЕСТЬNULL(ТабВалЗакуп.Кратность, 1) * ЕСТЬNULL(ВалРуб.Курс, 1)), 0))) КАК СебестоимостьБезнал,
	СУММА(Прод.Количество) КАК Количество,
	NULL КАК СуммаНаличка,
	NULL КАК КоличествоНаличка,
	NULL КАК СебестоимостьНаличка,
	NULL КАК ЧекКоличество,
	NULL КАК ЗаказИнтКолво,
	Оплат.Автор.Отдел,
	Оплат.Автор КАК Автор
ПОМЕСТИТЬ СебестоимостьЗаказовПоМагазинам
ИЗ
	ОплатыПоМагазинам КАК Оплат
		ЛЕВОЕ СОЕДИНЕНИЕ ТоварыЗаказовПоМагазинам КАК Прод
		ПО Оплат.Заказ = Прод.Заказ
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенСебестоимостьДляРасчетаЗП.Значение
						ИЗ
							Константа.ТипЦенСебестоимостьДляРасчетаЗП КАК ТипЦенСебестоимостьДляРасчетаЗП)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенСеб
		ПО (Прод.Номенклатура = ЦенСеб.Номенклатура)
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаВалютПоДнямПоМагазинам КАК ТабВал
		ПО Оплат.ДокументОплаты = ТабВал.ДокументОплаты
			И (ЦенСеб.Валюта = ТабВал.Валюта)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенЗакупочныйРуб.Значение
						ИЗ
							Константа.ТипЦенЗакупочныйРуб КАК ТипЦенЗакупочныйРуб)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенЗак
		ПО (Прод.Номенклатура = ЦенЗак.Номенклатура)
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаВалютПоДнямПоМагазинам КАК ТабВалЗакуп
		ПО Оплат.ДокументОплаты = ТабВалЗакуп.ДокументОплаты
			И (ЦенЗак.Валюта = ТабВалЗакуп.Валюта)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют.СрезПоследних(
				{(&amp;КонецПериода)},
				Валюта В
					(ВЫБРАТЬ
						Константы.ВалютаУправленческогоУчета
					ИЗ
						Константы)) КАК ВалРуб
		ПО (ИСТИНА)
ГДЕ
	НЕ Оплат.Заказ.РозничнаяЗаявка = ИСТИНА

СГРУППИРОВАТЬ ПО
	Оплат.Автор,
	Оплат.Автор.Отдел

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	NULL,
	NULL,
	NULL,
	СУММА(ПродажиВРозницуОбороты.СуммаОборот),
	СУММА(ПродажиВРозницуОбороты.КоличествоОборот),
	СУММА(ПродажиВРозницуОбороты.КоличествоОборот * ЕСТЬNULL(ЦенСебНаличка.Цена * (ЕСТЬNULL(ТабВалНаличка.Курс, 1) * ЕСТЬNULL(ВалРуб.Кратность, 1)) / (ЕСТЬNULL(ТабВалНаличка.Кратность, 1) * ЕСТЬNULL(ВалРуб.Курс, 1)), ЕСТЬNULL(ЦенЗакНаличка.Цена * (ЕСТЬNULL(ТабВалЗакупНаличка.Курс, 1) * ЕСТЬNULL(ВалРуб.Кратность, 1)) / (ЕСТЬNULL(ТабВалЗакупНаличка.Кратность, 1) * ЕСТЬNULL(ВалРуб.Курс, 1)), 0))),
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ ПродажиВРозницуОбороты.Чек),
	NULL,
	ПродажиВРозницуОбороты.Продавец.Отдел,
	ПродажиВРозницуОбороты.Продавец
ИЗ
	РегистрНакопления.ПродажиВРозницу.Обороты(
			{(&amp;НачалоПериода)},
			{(&amp;КонецПериода)},
			,
			Продавец В
				(ВЫБРАТЬ
					Авторы.Ссылка
				ИЗ
					Авторы)) КАК ПродажиВРозницуОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенСебестоимостьДляРасчетаЗП.Значение
						ИЗ
							Константа.ТипЦенСебестоимостьДляРасчетаЗП КАК ТипЦенСебестоимостьДляРасчетаЗП)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенСебНаличка
		ПО ПродажиВРозницуОбороты.Номенклатура = ЦенСебНаличка.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатуры.СрезПоследних(
				{(&amp;КонецПериода)},
				ТипЦен В
						(ВЫБРАТЬ
							ТипЦенЗакупочныйРуб.Значение
						ИЗ
							Константа.ТипЦенЗакупочныйРуб КАК ТипЦенЗакупочныйРуб)
					И Упаковка = &amp;ПустаяУпаковка) КАК ЦенЗакНаличка
		ПО ПродажиВРозницуОбороты.Номенклатура = ЦенЗакНаличка.Номенклатура
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаВалютПоДнямПродажиНаличка КАК ТабВалНаличка
		ПО (ЦенСебНаличка.Валюта = ТабВалНаличка.Валюта)
			И ПродажиВРозницуОбороты.Чек = ТабВалНаличка.ДокументПродажи
		ЛЕВОЕ СОЕДИНЕНИЕ ТаблицаВалютПоДнямПродажиНаличка КАК ТабВалЗакупНаличка
		ПО (ЦенЗакНаличка.Валюта = ТабВалЗакупНаличка.Валюта)
			И ПродажиВРозницуОбороты.Чек = ТабВалЗакупНаличка.ДокументПродажи
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КурсыВалют.СрезПоследних(
				{(&amp;КонецПериода)},
				Валюта В
					(ВЫБРАТЬ
						Константы.ВалютаУправленческогоУчета
					ИЗ
						Константы)) КАК ВалРуб
		ПО (ИСТИНА)

СГРУППИРОВАТЬ ПО
	ПродажиВРозницуОбороты.Продавец,
	ПродажиВРозницуОбороты.Продавец.Отдел
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	СУММА(ЕСТЬNULL(СебестоимостьЗаказов.СуммаНаличка, 0) + ЕСТЬNULL(СебестоимостьЗаказов.СуммаБезнал, 0)) КАК СуммаПродаж,
	СУММА(ЕСТЬNULL(СебестоимостьЗаказов.СуммаНаличка, 0) + ЕСТЬNULL(СебестоимостьЗаказов.СуммаБезнал, 0) - ЕСТЬNULL(СебестоимостьЗаказов.СебестоимостьБезнал, 0) - ЕСТЬNULL(СебестоимостьЗаказов.СебестоимостьНаличка, 0)) КАК ВаловаяПрибыль,
	СебестоимостьЗаказов.Автор КАК Автор,
	СебестоимостьЗаказов.АвторОтдел КАК ОтделРозница
ПОМЕСТИТЬ втСуммарныеПродажиРозницаНалИБезн
ИЗ
	СебестоимостьЗаказовПоМагазинам КАК СебестоимостьЗаказов

СГРУППИРОВАТЬ ПО
	СебестоимостьЗаказов.Автор,
	СебестоимостьЗаказов.АвторОтдел
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	втСуммарныеПродажиРозницаНалИБезн.ОтделРозница,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ втСуммарныеПродажиРозницаНалИБезн.Автор) КАК КоличествоАвторов
ПОМЕСТИТЬ втКоличествоАвторов
ИЗ
	втСуммарныеПродажиРозницаНалИБезн КАК втСуммарныеПродажиРозницаНалИБезн

СГРУППИРОВАТЬ ПО
	втСуммарныеПродажиРозницаНалИБезн.ОтделРозница
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ЕСТЬNULL(втПлановыеДанные.Менеджер, втСуммарнаяПрибыльПоМенеджерам.Менеджер) КАК Менеджер,
	ЕСТЬNULL(втПлановыеДанные.Менеджер.Отдел, втСуммарнаяПрибыльПоМенеджерам.Менеджер.Отдел) КАК Отдел,
	втСуммарнаяПрибыльПоМенеджерам.СуммаОплаты КАК СуммаПродажОплаты,
	втСуммарнаяПрибыльПоМенеджерам.ВаловаяПрибыль,
	втПлановыеДанные.План,
	0 КАК ВыполнениеПланаПоКустам
ИЗ
	втПлановыеДанные КАК втПлановыеДанные
		ПОЛНОЕ СОЕДИНЕНИЕ втСуммарнаяПрибыльПоМенеджерам КАК втСуммарнаяПрибыльПоМенеджерам
		ПО втПлановыеДанные.Менеджер = втСуммарнаяПрибыльПоМенеджерам.Менеджер

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЕСТЬNULL(втСуммарныеПродажиРозницаНалИБезн.Автор, ЗНАЧЕНИЕ(Справочник.Пользователи.ПустаяСсылка)),
	ЕСТЬNULL(втСуммарныеПродажиРозницаНалИБезн.ОтделРозница, втПлановыеДанныеПоМагазинам.ОтделРозница),
	втСуммарныеПродажиРозницаНалИБезн.СуммаПродаж,
	втСуммарныеПродажиРозницаНалИБезн.ВаловаяПрибыль,
	втПлановыеДанныеПоМагазинам.План / ЕСТЬNULL(втКоличествоАвторов.КоличествоАвторов, 1),
	0
ИЗ
	втСуммарныеПродажиРозницаНалИБезн КАК втСуммарныеПродажиРозницаНалИБезн
		ПОЛНОЕ СОЕДИНЕНИЕ втПлановыеДанныеПоМагазинам КАК втПлановыеДанныеПоМагазинам
		ПО втСуммарныеПродажиРозницаНалИБезн.ОтделРозница = втПлановыеДанныеПоМагазинам.ОтделРозница
		ЛЕВОЕ СОЕДИНЕНИЕ втКоличествоАвторов КАК втКоличествоАвторов
		ПО втСуммарныеПродажиРозницаНалИБезн.ОтделРозница = втКоличествоАвторов.ОтделРозница</query>
	</dataSet>
	<totalField>
		<dataPath>План</dataPath>
		<expression>Сумма(План)</expression>
	</totalField>
	<totalField>
		<dataPath>СуммаПродажОплаты</dataPath>
		<expression>Сумма(СуммаПродажОплаты)</expression>
	</totalField>
	<totalField>
		<dataPath>ВаловаяПрибыль</dataPath>
		<expression>Сумма(ВаловаяПрибыль)</expression>
	</totalField>
	<totalField>
		<dataPath>ВыполнениеПланаПоКустам</dataPath>
		<expression>ВЫБОР КОГДА Сумма(План)=0 ИЛИ Сумма(План) ЕСТЬ NULL ТОГДА NULL ИНАЧЕ Сумма(СуммаПродажОплаты) / Сумма(План) * 100 КОНЕЦ</expression>
	</totalField>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>v8:StandardPeriod</v8:Type>
		</valueType>
		<value xsi:type="v8:StandardPeriod">
			<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
			<v8:startDate>0001-01-01T00:00:00</v8:startDate>
			<v8:endDate>0001-01-01T00:00:00</v8:endDate>
		</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>МенеджерОплаты</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Менеджер оплаты</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">true</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>МенеджерОтдел</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Менеджер отдел</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Отделы</v8:Type>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>Менеджер</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Менеджер</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Пользователи</v8:Type>
			<v8:TypeSet xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:Characteristic.АналитикиСтатейБюджета</v8:TypeSet>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>МенеджерПодразделение</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Менеджер подразделение</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Подразделения</v8:Type>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>СтатьяБюджета</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Статья бюджета</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СтатьиБюджета</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>Сценарий</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СценарииПланирования</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>МагазинОтдел</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Магазин отдел</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Отделы</v8:Type>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>Магазин</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Магазин</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Пользователи</v8:Type>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>МагазинПодразделение</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Магазин подразделение</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Подразделения</v8:Type>
		</valueType>
		<useRestriction>false</useRestriction>
		<valueListAllowed>true</valueListAllowed>
	</parameter>
	<parameter>
		<name>ПустаяУпаковка</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Пустая упаковка</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.УпаковкиНоменклатуры</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">Справочник.УпаковкиНоменклатуры.ПустаяСсылка</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>Ставка18</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Ставка18</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:EnumRef.СтавкиНДС</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">Перечисление.СтавкиНДС.НДС18</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаНачала</expression>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>&amp;Период.ДатаОкончания</expression>
	</parameter>
	<parameter>
		<name>КонецПериодаЗаказа</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода заказа</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>НачалоПериодаЗаказа</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода заказа</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>ЦеныНаДату</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Цены на дату</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="xs:string">Основной</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>План</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>СуммаПродажОплаты</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ВаловаяПрибыль</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ВыполнениеПланаПоКустам</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Период</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardPeriod">
						<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
						<v8:startDate>0001-01-01T00:00:00</v8:startDate>
						<v8:endDate>0001-01-01T00:00:00</v8:endDate>
					</dcscor:value>
					<dcsset:userSettingID>1b1f15c3-fe31-4863-9f2e-12380e27e490</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МенеджерОплаты</dcscor:parameter>
					<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
					<dcsset:userSettingID>ec1ec9f2-6fb0-4d3c-95e2-fdb131e2a9eb</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>МенеджерОтдел</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>6ab4b4ed-6d28-4ade-8c7c-3f78a627d047</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Менеджер</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>5f51b4a5-6971-40f0-83c0-42b24eecef4d</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>МенеджерПодразделение</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>4bd300f2-e09c-4a8c-b051-b22567471010</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>СтатьяБюджета</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>ef15f0bf-512e-4e87-acd2-9023737303c3</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Сценарий</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>30f0ed3a-a8b3-41e6-bb24-dd837e5e621f</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>МагазинОтдел</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>f3aaedca-13f8-4307-8a02-45bad95cd26f</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>Магазин</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>80d86d54-5e93-4551-ab30-7a679d01ab24</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:use>false</dcscor:use>
					<dcscor:parameter>МагазинПодразделение</dcscor:parameter>
					<dcscor:value xsi:nil="true"/>
					<dcsset:userSettingID>2f6caa84-bf41-4ab7-af8a-fc2da793d8d8</dcsset:userSettingID>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:conditionalAppearance>
				<dcsset:item>
					<dcsset:selection/>
					<dcsset:filter/>
					<dcsset:appearance>
						<dcscor:item xsi:type="dcsset:SettingsParameterValue">
							<dcscor:parameter>Формат</dcscor:parameter>
							<dcscor:value xsi:type="v8:LocalStringType">
								<v8:item>
									<v8:lang>ru</v8:lang>
									<v8:content>ЧДЦ=2</v8:content>
								</v8:item>
							</dcscor:value>
						</dcscor:item>
					</dcsset:appearance>
				</dcsset:item>
			</dcsset:conditionalAppearance>
			<dcsset:outputParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>МакетОформления</dcscor:parameter>
					<dcscor:value xsi:type="xs:string">Яркий</dcscor:value>
				</dcscor:item>
			</dcsset:outputParameters>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:groupItems>
					<dcsset:item xsi:type="dcsset:GroupItemField">
						<dcsset:field>Отдел</dcsset:field>
						<dcsset:groupType>Items</dcsset:groupType>
						<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
						<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
						<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
					</dcsset:item>
				</dcsset:groupItems>
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
				<dcsset:item xsi:type="dcsset:StructureItemGroup">
					<dcsset:groupItems>
						<dcsset:item xsi:type="dcsset:GroupItemField">
							<dcsset:field>Менеджер</dcsset:field>
							<dcsset:groupType>Items</dcsset:groupType>
							<dcsset:periodAdditionType>None</dcsset:periodAdditionType>
							<dcsset:periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionBegin>
							<dcsset:periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</dcsset:periodAdditionEnd>
						</dcsset:item>
					</dcsset:groupItems>
					<dcsset:order>
						<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
					</dcsset:order>
					<dcsset:selection>
						<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
					</dcsset:selection>
				</dcsset:item>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>