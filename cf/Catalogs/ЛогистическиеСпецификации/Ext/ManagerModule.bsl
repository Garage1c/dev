Функция ПеренестиДанныеВЛогистическуюСпецификацию(ДанныеСпецификации) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	ЛогистическиеСпецификацииСостав.Ссылка,
	|	ЛогистическиеСпецификацииСостав.НомерСтроки,
	|	ЛогистическиеСпецификацииСостав.Поставщик,
	|	ЛогистическиеСпецификацииСостав.Импорт,
	|	ЛогистическиеСпецификацииСостав.СпособДоставки,
	|	ЛогистическиеСпецификацииСостав.Растаможка,
	|	ЛогистическиеСпецификацииСостав.ВремяЗабора,
	|	ЛогистическиеСпецификацииСостав.СанктПетербург,
	|	ЛогистическиеСпецификацииСостав.Москва,
	|	ЛогистическиеСпецификацииСостав.НижнийНовгород,
	|	ЛогистическиеСпецификацииСостав.Мурманск,
	|	ЛогистическиеСпецификацииСостав.Новокузнецк,
	|	ЛогистическиеСпецификацииСостав.Хабаровск,
	|	ЛогистическиеСпецификацииСостав.Автор,
	|	ЛогистическиеСпецификацииСостав.ДатаПоследнегоИзменения
	|ИЗ
	|	Справочник.ЛогистическиеСпецификации.Состав КАК ЛогистическиеСпецификацииСостав
	|ГДЕ
	|	ЛогистическиеСпецификацииСостав.Поставщик = &Поставщик
	|	И ЛогистическиеСпецификацииСостав.СпособДоставки = &СпособДоставки
	|	И НЕ ЛогистическиеСпецификацииСостав.Ссылка.ПометкаУдаления
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЛогистическиеСпецификацииСостав.Ссылка,
	|	ЛогистическиеСпецификацииСостав.НомерСтроки,
	|	ЛогистическиеСпецификацииСостав.Поставщик,
	|	ЛогистическиеСпецификацииСостав.Импорт,
	|	ЛогистическиеСпецификацииСостав.СпособДоставки,
	|	ЛогистическиеСпецификацииСостав.Растаможка,
	|	ЛогистическиеСпецификацииСостав.ВремяЗабора,
	|	ЛогистическиеСпецификацииСостав.СанктПетербург,
	|	ЛогистическиеСпецификацииСостав.Москва,
	|	ЛогистическиеСпецификацииСостав.НижнийНовгород,
	|	ЛогистическиеСпецификацииСостав.Мурманск,
	|	ЛогистическиеСпецификацииСостав.Новокузнецк,
	|	ЛогистическиеСпецификацииСостав.Хабаровск,
	|	ЛогистическиеСпецификацииСостав.Автор,
	|	ЛогистическиеСпецификацииСостав.ДатаПоследнегоИзменения
	|ИЗ
	|	Справочник.ЛогистическиеСпецификации.Состав КАК ЛогистическиеСпецификацииСостав
	|ГДЕ
	|	ЛогистическиеСпецификацииСостав.Поставщик = &Поставщик
	|	И НЕ ЛогистическиеСпецификацииСостав.Ссылка.ПометкаУдаления
	|;
	|
	|////////////////////////////////////////////////////////////////////////////////
	|ВЫБРАТЬ
	|	ЛогистическиеСпецификации.Ссылка
	|ИЗ
	|	Справочник.ЛогистическиеСпецификации КАК ЛогистическиеСпецификации
	|ГДЕ
	|	НЕ ЛогистическиеСпецификации.ПометкаУдаления";
	
	Запрос.УстановитьПараметр("Поставщик", ДанныеСпецификации.Поставщик);
	Запрос.УстановитьПараметр("СпособДоставки", ДанныеСпецификации.СпособДоставки);
	
	Результаты = Запрос.ВыполнитьПакет();
	
	Выборка1 = Результаты[0].Выбрать();
	Выборка2 = Результаты[1].Выбрать();
	Выборка3 = Результаты[2].Выбрать();
	
	Если Выборка1.Следующий() Тогда
		
		ЛогСпецификацияОбъект = Выборка1.Ссылка.ПолучитьОбъект();
		СтрокиСпецификации = ЛогСпецификацияОбъект.Состав.НайтиСтроки(Новый Структура("Поставщик,СпособДоставки", ДанныеСпецификации.Поставщик, ДанныеСпецификации.СпособДоставки));
		
		Если СтрокиСпецификации.Количество() > 0 Тогда
			ЗаполнитьЗначенияСвойств(СтрокиСпецификации[0], ДанныеСпецификации);
			ЛогСпецификацияОбъект.Записать();
		КонецЕсли;
		
	ИначеЕсли Выборка2.Следующий() Тогда  
		
		ЛогСпецификацияОбъект = Выборка2.Ссылка.ПолучитьОбъект();
		СтрокаСпецификации = ЛогСпецификацияОбъект.Состав.Найти(ДанныеСпецификации.Поставщик, "Поставщик");
		ЗаполнитьЗначенияСвойств(СтрокаСпецификации, ДанныеСпецификации);
		ЛогСпецификацияОбъект.Записать();
		
	ИначеЕсли Выборка3.Следующий() Тогда 
		
		ЛогСпецификацияОбъект = Выборка3.Ссылка.ПолучитьОбъект();
		СтрокаСпецификации = ЛогСпецификацияОбъект.Состав.Добавить();
		ЗаполнитьЗначенияСвойств(СтрокаСпецификации, ДанныеСпецификации);
		ЛогСпецификацияОбъект.Записать();
		
	Иначе 
		
		ЛогСпецификацияОбъект = Справочники.ЛогистическиеСпецификации.СоздатьЭлемент();
		НоваяСтрока = ЛогСпецификацияОбъект.Состав.Добавить();
		ЗаполнитьЗначенияСвойств(НоваяСтрока, ДанныеСпецификации);
		ЛогСпецификацияОбъект.Наименование = "Логистическая спецификация";
		ЛогСпецификацияОбъект.Записать();
		
	КонецЕсли;	
	
	Возврат ЛогСпецификацияОбъект.Ссылка;
	
КонецФункции