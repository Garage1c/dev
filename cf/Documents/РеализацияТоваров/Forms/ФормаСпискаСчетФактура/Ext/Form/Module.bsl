&НаСервере
Функция ПолучитьВыбранныйДокумент(ЗаписьРегистра)
	
	Возврат ЗаписьРегистра.Основание;
	
КонецФункции

&НаКлиенте
Процедура СписокВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	СтандартнаяОбработка = Ложь;
	ОткрытьФорму("Документ.РеализацияТоваров.Форма.ФормаСчетФактура", Новый Структура("Основание", ПолучитьВыбранныйДокумент(ВыбраннаяСтрока)), ЭтаФорма);
КонецПроцедуры

&НаКлиенте
Процедура ВыгрузитьВБухгалтерию(Команда)
	
	ПараметрКоманды = Новый Массив;
	ПараметрКоманды.Добавить(Элементы.Список.ТекущаяСтрока);
	
	стрОшибок 	= "";
	Ошибка 		= Ложь;
	Всего 		= ПараметрКоманды.Количество();
	Ном			= 0;
	
	Для Каждого СсылкаНаОбъект Из ПараметрКоманды Цикл Ном = Ном + 1;
		
		стрОшибки = "";
		Если Не ВыгрузитьНаСервере(СсылкаНаОбъект, стрОшибки) Тогда
			стрОшибок = стрОшибок + ?(Ошибка, Символы.ПС,"") +  "Ошибка при переносе " + СсылкаНаОбъект + стрОшибки;
			Ошибка = Истина;
		КонецЕсли;
		
		Если Всего > 1 Тогда
			Состояние("Выгружен документ в бухгалтерию 2.0" , Ном / Всего * 100 , СсылкаНаОбъект);
		КонецЕсли;
				
	КонецЦикла;
	
	Если Ошибка Тогда
		ОбщиеФункции.СообщитьТекст(стрОшибок);
	Иначе
		ПоказатьПредупреждение(,"Выбранные данные выгруженны.",,"Предупреждение");
	КонецЕсли;
	
КонецПроцедуры


&НаСервере
Функция ВыгрузитьНаСервере(СсылкаНаОбъект, стрОшибки)
	
	Ссылка81 = ИнтеграцияСБухгалтериейСервер.ПолучитьОбъектВБухгалтерии(СсылкаНаОбъект,,,,,стрОшибки);
	Возврат Ссылка81 <> Неопределено;
	
КонецФункции
